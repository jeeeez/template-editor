(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"./docz/Introduction.mdx":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var r=n("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),o=(n("./node_modules/react/index.js"),n("./node_modules/@mdx-js/react/dist/index.es.js")),a=n("./node_modules/docz/dist/index.esm.js"),i=n("./src/index.tsx"),l={},c="wrapper";function s(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(o.b)(c,Object.assign({},l,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h1",{id:"introduction"},"Introduction"),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"ReactTemplateEditor")," is a ",Object(o.b)("inlineCode",{parentName:"p"},"React")," component of ",Object(o.b)("inlineCode",{parentName:"p"},"TemplateEditor(@template-editor/native)"),",",Object(o.b)("br",null),"\nIt's a ",Object(o.b)("inlineCode",{parentName:"p"},"CodeMirror")," based template editor usually used as ",Object(o.b)("inlineCode",{parentName:"p"},"message editor")," or ",Object(o.b)("inlineCode",{parentName:"p"},"wechat message editor"),"."),Object(o.b)("p",null,"Unfortunately this is not a strictly controlled component, but we are trying to improve it."),Object(o.b)("h2",{id:"install"},"Install"),Object(o.b)("pre",null,Object(o.b)("code",Object.assign({parentName:"pre"},{className:"language-bash"}),"npm i @template-editor/react\n# or\nyarn add @template-editor/react\n")),Object(o.b)("p",null,"Then use it in your code..."),Object(o.b)("pre",null,Object(o.b)("code",Object.assign({parentName:"pre"},{className:"language-javascript"}),"import { ReactTemplateEditor } from '@template-editor/react';\n\n<ReactTemplateEditor\n  value=''\n  placeholder='',\n  placeholders={[] as IPlaceholder[]}\n/>\n\n")),Object(o.b)("h2",{id:"props"},"Props"),Object(o.b)(a.d,{of:i.a,mdxType:"Props"}),Object(o.b)("h2",{id:"type-definitions"},"Type Definitions"),Object(o.b)("h3",{id:"iplaceholder"},"IPlaceholder"),Object(o.b)("pre",null,Object(o.b)("code",Object.assign({parentName:"pre"},{className:"language-typescript"}),"interface IPlaceholder {\n  matchRegexp: RegExp;\n  consumeRegexp?: RegExp; // default to matchRegexp\n  type: string; // value of CodeMirror.Token.type\n  text?: string | ((v: string) => string); // display text of this placeholder\n  className?: string;\n}\n")),Object(o.b)("h3",{id:"ieditoroptions"},"IEditorOptions"),Object(o.b)("p",null,"The second argument of ",Object(o.b)("inlineCode",{parentName:"p"},"TemplateEditor")),Object(o.b)("pre",null,Object(o.b)("code",Object.assign({parentName:"pre"},{className:"language-typescript"}),"interface IEditorOptions {\n  initialValue: string;\n  placeholders: IPlaceholder[];\n  lineWrapping?: boolean;\n  createReplacementNode?(\n    placeholder: IPlaceholder,\n    value?: string, // the real Value of the matched Placeholder. `matchRegexp(input)[1]`\n    input?: string // consumed string of the Placeholder\n  ): HTMLSpanElement;\n}\n")))}s&&s===Object(s)&&Object.isExtensible(s)&&Object.defineProperty(s,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"MDXContent",filename:"docz\\Introduction.mdx"}}),s.isMDXComponent=!0},"./src/index.tsx":function(e,t,n){"use strict";var r=n("./node_modules/react/index.js"),o=n("../editor/node_modules/codemirror/lib/codemirror.js"),a=n.n(o),i=(n("../editor/node_modules/codemirror/lib/codemirror.css"),n("../editor/node_modules/codemirror/addon/scroll/simplescrollbars.css"),function(e){var t="function"===typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}),l=0;function c(e,t){var n=document.createElement("span");return n.innerHTML=e,t&&t.split(" ").forEach(function(e){e&&n.classList.add(e)}),n}n("../editor/node_modules/codemirror/addon/scroll/simplescrollbars.js"),n("../editor/node_modules/codemirror/addon/display/placeholder.js");var s=function(){function e(e,t){this.options=t;var n,r,o=(n={placeholders:t.placeholders},r="Template-Editor-"+ ++l+"-"+Date.now(),a.a.defineMode(r,function(){function e(e,t){var r,o;t.line=e.lineOracle.line;try{for(var a=i(n.placeholders),l=a.next();!l.done;l=a.next()){var c=l.value;if(e.match(c.matchRegexp,!1)){var s=c.consumeRegexp||c.matchRegexp,d=e.match(s);return t.placeholder=c,t.matchedValue=d[1],c.type}}}catch(p){r={error:p}}finally{try{l&&!l.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return e.next(),null}return{startState:function(){return{tokenize:e,context:null}},token:function(t,n){return n.tokenize===e&&t.eatSpace()?(n.placeholder=void 0,n.matchedValue=void 0,null):n.tokenize(t,n)}}}),r),c=!("lineWrapping"in t)||!!t.lineWrapping;this.instance=a()(e,{mode:o,lineWrapping:c,scrollbarStyle:"simple",readOnly:!!t.disabled&&"nocursor",value:t.initialValue||"",placeholder:t.placeholder}),this.replaceVariables(),this.listenContentChange()}return e.prototype.listenContentChange=function(){var e=this;this.instance.on("change",function(){e.replaceVariables()})},e.prototype.replaceVariables=function(){var e=this.options.createReplacementNode,t=this.instance.getDoc();t.getAllMarks().forEach(function(e){e.clear()}),this.getTokens().forEach(function(n){if(n&&n.type&&n.state&&n.state.placeholder){var r=n.state.line,o={line:r,ch:n.start},a={line:r,ch:n.end},i=n.state.placeholder,l=n.state.matchedValue,s=e?e(i,l,n.string):c(i&&i.hasOwnProperty("text")?"string"===typeof i.text?i.text:i.text(l):l,i&&i.hasOwnProperty("className")?i.className:"cm-variable");t.markText(o,a,{replacedWith:s})}})},e.prototype.getTokens=function(){var e=this,t=[];return this.instance.getDoc().eachLine(function(n){e.instance.getLineTokens(n.lineNo()).forEach(function(e){return t.push(e)})}),t},e.prototype.getValue=function(){return this.instance.getDoc().getValue()},e.prototype.setValue=function(e){this.instance.getDoc().setValue(e)},e.prototype.onChange=function(e){var t=this;this.instance.on("change",function(){e(t.getValue())})},e}();n.d(t,"a",function(){return m});var d=function(){return(d=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},p=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]])}return n},u=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,a=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(l){o={error:l}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i},m=r.forwardRef(function(e,t){var n=e.value,o=void 0===n?"":n,a=e.style,i=e.disabled,l=e.placeholder,c=e.placeholders,m=e.createReplacementNode,b=e.onChange,f=p(e,["value","style","disabled","placeholder","placeholders","createReplacementNode","onChange"]),h=r.useRef(null),g=u(r.useState(),2),y=g[0],O=g[1];return r.useEffect(function(){O(new s(h.current,{initialValue:o,disabled:i,placeholder:l,placeholders:c,createReplacementNode:m}))},[]),r.useEffect(function(){b&&y.onChange(function(e){var t=y.getTokens();b(e,t)})},[]),r.useEffect(function(){y&&y.setValue(e.value)},[e.value]),r.useEffect(function(){y&&y.instance.setOption("placeholder",l)},[e.placeholder]),r.useEffect(function(){y&&y.instance.setOption("readOnly",!!i&&"nocursor")},[e.disabled]),r.useImperativeHandle(t,function(){return{forceUpdateEditor:function(){y.setValue(e.value+" "),setTimeout(function(){y.setValue(e.value)},0)}}}),r.createElement("div",d({ref:h,style:d({border:"1px solid #d9d9d9",borderRadius:2},a)},f))});"undefined"!==typeof m&&m&&m===Object(m)&&Object.isExtensible(m)&&Object.defineProperty(m,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"ReactTemplateEditor",filename:"src\\index.tsx"}})}}]);
//# sourceMappingURL=docz-introduction.68bed8bb17841160d63e.js.map